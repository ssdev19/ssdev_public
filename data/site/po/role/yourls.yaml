---
classes:
  - profile::base_linux
  - profile::yourls
profile::base_linux::awscli: true
profile::yourls::yourls_version: '1.9.2' # If you change this version, ensure to update file rubinobs_facts.rb
profile::yourls::yourls_site: 'https://ls2.ls.st'
# php::manage_repos: true
php::fpm: true
php::fpm_user: 'nginx'
php::fpm_group: 'nginx'
nginx::nginx_servers:
  'yourls':
    www_root: '/etc/nginx/YOURLS'
    server_name: ['ls2.ls.st']
    listen_port: 80
    index_files: ['index', 'index.php', 'index.html', 'index.htm']
    location_cfg_append: 
      'location ~* ^/LDM[\ -]([0-9]+)\~$'
        'return': '301 https://docushare.lsst.org/docushare/dsweb/Services/LDM-$1'
    location_cfg_append: 
      'location ~* ^/LDM[\ -]([0-9]+)$'
        'return': '301 https://docushare.lsst.org/docushare/dsweb/Get/LDM-$1'
#     ssl_port: 443
#     ssl: true
#     ssl_cert: '/etc/pki/tls/certs/ls.st.current.crt'
#     ssl_key: '/etc/pki/tls/certs/ls.st.current.key'
  # 'ls2.ls.st':
  #   proxy: 'https://ls2.ls.st'

# nginx::resource::server:
#   'yourlstest':
#     ensure: 'present'
#     www_root: '/etc/nginx/YOURLS'
#     server_name: yourls
#     listen_port: 80

